{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import'../css/review.css';import Review from\"../components/Review\";import{makeStyles}from'@material-ui/styles';import{Button,FormControl,Input,InputLabel}from'@material-ui/core';var useStyles=makeStyles(function(theme){return{submit:{marginTop:theme.spacing*3,justifySelf:'center',color:'white'}};});export default function Reviews(props){var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),reviews=_useState2[0],setReviews=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),searchStr=_useState4[0],setSearchStr=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),clearSearch=_useState6[0],setClearSearch=_useState6[1];useEffect(function(){var isFetching=true;var fetchReviews=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios('https://read-it-react.herokuapp.com/getReviews');case 3:response=_context.sent;console.log(response.data);if(isFetching){setReviews(response.data);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(_context.t0){props.onError(_context.t0.response.data.error);}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchReviews(){return _ref.apply(this,arguments);};}();fetchReviews();return function(){return isFetching=false;};},[props,clearSearch]);var handleDeleteReview=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var response,newReviewedBooks;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post('https://read-it-react.herokuapp.com/deleteReview',{id:id});case 3:response=_context2.sent;console.log(response.data);props.onNotification(response.data.response);newReviewedBooks=reviews.filter(function(review){return review.id!==id;});setReviews(newReviewedBooks);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](0);if(_context2.t0){props.onError(_context2.t0.response.data.error);}case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,10]]);}));return function handleDeleteReview(_x){return _ref2.apply(this,arguments);};}();var handleSubmit=function handleSubmit(e){e.preventDefault();if(searchStr){var matches=reviews.filter(function(review){console.log(review);if(review.book_title.toLowerCase().includes(searchStr.toLowerCase())||review.user.first_name.toLowerCase().includes(searchStr.toLowerCase())||review.user.last_name.toLowerCase().includes(searchStr.toLowerCase())){return review;}});console.log(matches.length);if(matches.length===0){console.log(matches);props.onError('No reviews match your search');return;}else{setReviews(matches);}}};return/*#__PURE__*/React.createElement(\"div\",{className:\"reviewsWrapper\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Reviews\"),searchStr?/*#__PURE__*/React.createElement(\"div\",{className:\"clearBtn btn\",onClick:function onClick(){return setClearSearch(true);}},\"Clear Search\"):null,/*#__PURE__*/React.createElement(\"form\",{className:\"searchForm\"},/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"searchStr\"},\"Search for Reviews\"),/*#__PURE__*/React.createElement(Input,{name:\"searchStr\",type:\"text\",id:\"searchStr\",onChange:function onChange(e){return setSearchStr(e.target.value);}})),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"secondary\",className:classes.submit,onClick:function onClick(e){return handleSubmit(e);}},\"Search\")),reviews?reviews.map(function(review){return/*#__PURE__*/React.createElement(Review,Object.assign({},review,{key:review.id,onDelete:handleDeleteReview}));}):null);}","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/pages/Reviews.js"],"names":["React","useState","useEffect","axios","Review","makeStyles","Button","FormControl","Input","InputLabel","useStyles","theme","submit","marginTop","spacing","justifySelf","color","Reviews","props","classes","reviews","setReviews","searchStr","setSearchStr","clearSearch","setClearSearch","isFetching","fetchReviews","response","console","log","data","onError","error","handleDeleteReview","id","post","onNotification","newReviewedBooks","filter","review","handleSubmit","e","preventDefault","matches","book_title","toLowerCase","includes","user","first_name","last_name","length","target","value","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport '../css/review.css'\r\nimport Review from \"../components/Review\";\r\n\r\nimport { makeStyles } from '@material-ui/styles'\r\nimport {\r\n    Button,\r\n    FormControl,\r\n    Input,\r\n    InputLabel\r\n  } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n     submit: {\r\n      marginTop: theme.spacing * 3,\r\n      justifySelf: 'center',\r\n      color:'white'\r\n    },\r\n  }));\r\n\r\nexport default function Reviews(props) {\r\n\r\n    const classes = useStyles()\r\n\r\n    const [ reviews, setReviews ] = useState()\r\n    const [ searchStr, setSearchStr ] = useState()\r\n    const [ clearSearch, setClearSearch ] = useState(false)\r\n\r\n    useEffect(() => {\r\n        let isFetching = true\r\n        const fetchReviews = async () => {\r\n            try{\r\n                const response = await axios('https://read-it-react.herokuapp.com/getReviews')\r\n                console.log(response.data)\r\n                if(isFetching){\r\n                    setReviews(response.data)\r\n                }\r\n            }catch(err){\r\n                if(err){\r\n                    props.onError(err.response.data.error)\r\n                 }\r\n            }\r\n           \r\n        } \r\n        fetchReviews()\r\n        return () => isFetching= false\r\n    },[props, clearSearch])\r\n\r\n    const handleDeleteReview = async (id) => {\r\n        try{\r\n            const response =  await axios.post('https://read-it-react.herokuapp.com/deleteReview', {id})\r\n        console.log(response.data)\r\n        props.onNotification(response.data.response)\r\n        const newReviewedBooks = reviews.filter(review => review.id !== id)\r\n        setReviews(newReviewedBooks)\r\n            \r\n        }catch(err){\r\n            if(err){\r\n                props.onError(err.response.data.error)                \r\n             }\r\n        }\r\n    }\r\n\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault()\r\n        if(searchStr){\r\n           const matches = reviews.filter(review => {\r\n               console.log(review)\r\n            if(review.book_title.toLowerCase().includes(searchStr.toLowerCase()) \r\n            || review.user.first_name.toLowerCase().includes(searchStr.toLowerCase()) \r\n            || review.user.last_name.toLowerCase().includes(searchStr.toLowerCase()) ){\r\n                return review\r\n            }\r\n        })\r\n        console.log(matches.length)\r\n        if(matches.length === 0){\r\n            console.log(matches)\r\n            props.onError('No reviews match your search')\r\n            return\r\n        }else{\r\n            setReviews(matches)\r\n\r\n        }\r\n        }\r\n    }\r\n\r\n    return(\r\n        <div className=\"reviewsWrapper\">\r\n            <h1>Reviews</h1>\r\n                {searchStr? <div className=\"clearBtn btn\" onClick={() => setClearSearch(true)}>Clear Search</div>:null}\r\n            <form className=\"searchForm\">\r\n                <FormControl margin=\"normal\" fullWidth>\r\n                    <InputLabel htmlFor=\"searchStr\">Search for Reviews</InputLabel>\r\n                    <Input name=\"searchStr\" type=\"text\" id=\"searchStr\"  onChange={(e) => setSearchStr(e.target.value)}/>\r\n                </FormControl>\r\n                <Button\r\n                    type=\"submit\"\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    color=\"secondary\"\r\n                    className={classes.submit}\r\n                    onClick={(e)=> handleSubmit(e)}\r\n                    >Search</Button>\r\n            </form>\r\n            {reviews ? \r\n            reviews.map(review => {\r\n                return <Review {...review} key={review.id} onDelete={handleDeleteReview}/>                \r\n            })\r\n        : null}\r\n        \r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}