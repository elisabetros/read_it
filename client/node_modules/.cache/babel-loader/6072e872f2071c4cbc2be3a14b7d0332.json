{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\src\\\\components\\\\SearchResult.js\";\nimport React, { useState, useEffect } from \"react\";\nimport '../css/searchResults.css';\nimport { BsHeart, BsHeartFill } from \"react-icons/bs\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport isAuthorized from \"../auth/isAuthorized\";\n\nconst SearchResult = props => {\n  //    const [ searchResults, setSearchResults] = useState(props)\n  const [isLiked, setLike] = useState(false);\n  console.log(props);\n  let authors = null;\n  let publishedYear;\n  let shortenedDesc;\n\n  const shortenDesc = (text, max) => {\n    return text && text.length > max ? text.slice(0, max).split(' ').slice(0, -1).join(' ') : text;\n  };\n\n  if (props.volumeInfo.hasOwnProperty('publishedYear')) {\n    publishedYear = props.volumeInfo.publishedDate.slice(0, 4);\n  }\n\n  if (props.volumeInfo.hasOwnProperty('description')) {\n    shortenedDesc = shortenDesc(props.volumeInfo.description, 150);\n  }\n\n  if (props.volumeInfo.hasOwnProperty('authors')) {\n    authors = props.volumeInfo.authors.map(author => {\n      return author;\n    });\n  }\n\n  const handleLike = async () => {\n    if (props.isAuthorized) {\n      if (!props.volumeInfo.hasOwnProperty('authors')) {\n        authors = null;\n      } else {\n        authors = authors.toString();\n      }\n\n      console.log(authors);\n\n      try {\n        const response = await axios.post('http://localhost/addBookToLibrary', {\n          bookID: props.id,\n          title: props.volumeInfo.title,\n          author: authors,\n          img: props.volumeInfo.imageLinks.thumbnail\n        });\n        console.log(response.data); // props.notification(response.data.response)\n\n        setLike(true);\n      } catch (err) {\n        if (err) {\n          // props.error(err.response.data.error)\n          console.log(err.response.data.error);\n        }\n      }\n    } else {\n      props.error('Please login to add a book to your library');\n    }\n  };\n\n  const handleUnlike = async () => {\n    console.log('remove from library'); // if(props.isAuthorized){\n\n    try {\n      const response = await axios.post('http://localhost/removeBookFromLibrary', {\n        likedBookID: props.id\n      });\n      console.log(response.data);\n      setLike(false);\n    } catch (err) {\n      if (err) {// props.error(err.response.data.error)\n      }\n    } // }  \n\n  };\n\n  useEffect(() => {\n    if (props.likedBooks) {\n      const isSame = props.likedBooks.find(book => book.book_id === props.id);\n\n      if (isSame) {\n        setLike(true);\n      } else {\n        setLike(false);\n      }\n    }\n  }, [props]);\n  console.log(props.likedBooks);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"searchResult\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, props.volumeInfo.imageLinks ? /*#__PURE__*/React.createElement(\"img\", {\n    src: props.volumeInfo.imageLinks.smallThumbnail,\n    alt: \"book cover\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 43\n    }\n  }) : null, !isLiked ? /*#__PURE__*/React.createElement(BsHeart, {\n    className: \"heartIcon\",\n    onClick: handleLike,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(BsHeartFill, {\n    className: \"heartIcon\",\n    onClick: handleUnlike,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, props.volumeInfo.title), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"authors\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, authors ? authors.map((author, index) => {\n    // console.log(author)\n    return /*#__PURE__*/React.createElement(\"h4\", {\n      key: author + index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 24\n      }\n    }, \" By: \", author);\n  }) : null), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 13\n    }\n  }, shortenedDesc, \" \", /*#__PURE__*/React.createElement(Link, {\n    to: '/bookdetail/' + props.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 32\n    }\n  }, \"...Read More\")), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 10\n    }\n  }, props.volumeInfo.publisher), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 10\n    }\n  }, publishedYear))); // }\n};\n\nexport default isAuthorized(SearchResult);","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/components/SearchResult.js"],"names":["React","useState","useEffect","BsHeart","BsHeartFill","axios","Link","isAuthorized","SearchResult","props","isLiked","setLike","console","log","authors","publishedYear","shortenedDesc","shortenDesc","text","max","length","slice","split","join","volumeInfo","hasOwnProperty","publishedDate","description","map","author","handleLike","toString","response","post","bookID","id","title","img","imageLinks","thumbnail","data","err","error","handleUnlike","likedBookID","likedBooks","isSame","find","book","book_id","smallThumbnail","index","publisher"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport  '../css/searchResults.css'\r\nimport { BsHeart, BsHeartFill} from \"react-icons/bs\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport isAuthorized from \"../auth/isAuthorized\";\r\n\r\nconst SearchResult = (props) => {\r\n//    const [ searchResults, setSearchResults] = useState(props)\r\n   const [ isLiked, setLike ] = useState(false)\r\n\r\nconsole.log(props)\r\nlet authors = null;\r\nlet publishedYear;\r\nlet shortenedDesc;\r\n\r\nconst shortenDesc = (text,max) => {\r\n    return text && text.length > max ? text.slice(0,max).split(' ').slice(0, -1).join(' ') : text\r\n}\r\n\r\nif(props.volumeInfo.hasOwnProperty('publishedYear')){\r\n    publishedYear = props.volumeInfo.publishedDate.slice(0,4)\r\n}\r\nif(props.volumeInfo.hasOwnProperty('description')){\r\n    shortenedDesc = shortenDesc(props.volumeInfo.description, 150)\r\n}\r\nif(props.volumeInfo.hasOwnProperty('authors')){\r\n    authors = props.volumeInfo.authors.map(author => {\r\n            return author\r\n        })\r\n    }\r\n   \r\n    const handleLike = async () => {\r\n        if(props.isAuthorized){\r\n       if(!props.volumeInfo.hasOwnProperty('authors')){\r\n           authors = null;\r\n       }else{\r\n           authors = authors.toString()\r\n       }\r\n        console.log(authors)\r\n        try{\r\n            const response = await axios.post('http://localhost/addBookToLibrary', {\r\n                bookID: props.id, \r\n                title: props.volumeInfo.title,\r\n                author: authors,\r\n                img: props.volumeInfo.imageLinks.thumbnail\r\n            })\r\n            console.log(response.data)\r\n            // props.notification(response.data.response)\r\n            setLike(true)\r\n        }catch(err){\r\n            if(err){\r\n                // props.error(err.response.data.error)\r\n                console.log(err.response.data.error)\r\n             }\r\n        }     \r\n        }else{\r\n        props.error('Please login to add a book to your library')\r\n        }    \r\n    }\r\n\r\n    const handleUnlike = async () => {\r\n        console.log('remove from library')\r\n        // if(props.isAuthorized){\r\n        try{\r\n            const response = await axios.post('http://localhost/removeBookFromLibrary', {likedBookID: props.id})\r\n            console.log(response.data)\r\n           setLike(false)\r\n        }catch(err){\r\n            if(err){\r\n                // props.error(err.response.data.error)\r\n            }\r\n        }    \r\n    // }  \r\n    }\r\n\r\n    useEffect(() => {\r\n        if(props.likedBooks){\r\n            const isSame = props.likedBooks.find(book => book.book_id === props.id)\r\n            if(isSame){\r\n                setLike(true)              \r\n            }else{\r\n                setLike(false)\r\n             }\r\n            }\r\n\r\n    }, [props])\r\n    \r\n    console.log(props.likedBooks)\r\n\r\n    return(\r\n        <div className=\"searchResult\" >\r\n           \r\n            {props.volumeInfo.imageLinks? <img src={props.volumeInfo.imageLinks.smallThumbnail} alt=\"book cover\" /> : null}\r\n            {!isLiked ?\r\n            <BsHeart className=\"heartIcon\" onClick={handleLike}/>\r\n            : <BsHeartFill className=\"heartIcon\" onClick={handleUnlike} /> }\r\n            <h3>{props.volumeInfo.title}</h3>\r\n            <div className=\"authors\">\r\n            {authors? authors.map((author, index) => {\r\n                // console.log(author)\r\n                return <h4 key={author+index}> By: {author}</h4>\r\n            }) : null }\r\n            </div>\r\n            <p>{shortenedDesc} <Link to={'/bookdetail/'+ props.id}>...Read More</Link></p>\r\n            <div>\r\n        \t<p>{props.volumeInfo.publisher}</p>\r\n        \t<p>{publishedYear}</p>\r\n            </div>\r\n            \r\n        </div>\r\n    )\r\n// }\r\n\r\n       \r\n        \r\n    \r\n}\r\nexport default isAuthorized(SearchResult)"]},"metadata":{},"sourceType":"module"}