{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import'../css/searchResults.css';import{BsHeart,BsHeartFill}from\"react-icons/bs\";import axios from\"axios\";import{Link}from\"react-router-dom\";import isAuthorized from\"../auth/isAuthorized\";var SearchResult=function SearchResult(props){//    const [ searchResults, setSearchResults] = useState(props)\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLiked=_useState2[0],setLike=_useState2[1];console.log(props);var authors=null;var publishedYear;var shortenedDesc;var shortenDesc=function shortenDesc(text,max){return text&&text.length>max?text.slice(0,max).split(' ').slice(0,-1).join(' '):text;};if(props.volumeInfo.hasOwnProperty('publishedYear')){publishedYear=props.volumeInfo.publishedDate.slice(0,4);}if(props.volumeInfo.hasOwnProperty('description')){shortenedDesc=shortenDesc(props.volumeInfo.description,150);}if(props.volumeInfo.hasOwnProperty('authors')){authors=props.volumeInfo.authors.map(function(author){return author;});}var handleLike=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!props.isAuthorized){_context.next=16;break;}if(!props.volumeInfo.hasOwnProperty('authors')){authors=null;}else{authors=authors.toString();}console.log(authors);_context.prev=3;_context.next=6;return axios.post('https://read-it-react.herokuapp.com/addBookToLibrary',{bookID:props.id,title:props.volumeInfo.title,author:authors,img:props.volumeInfo.imageLinks.thumbnail});case 6:response=_context.sent;console.log(response.data);// props.notification(response.data.response)\nsetLike(true);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);if(_context.t0){// props.error(err.response.data.error)\nconsole.log(_context.t0.response.data.error);}case 14:_context.next=17;break;case 16:props.error('Please login to add a book to your library');case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,11]]);}));return function handleLike(){return _ref.apply(this,arguments);};}();var handleUnlike=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('remove from library');// if(props.isAuthorized){\n_context2.prev=1;_context2.next=4;return axios.post('https://read-it-react.herokuapp.com/removeBookFromLibrary',{likedBookID:props.id});case 4:response=_context2.sent;console.log(response.data);setLike(false);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);if(_context2.t0){// props.error(err.response.data.error)\n}case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function handleUnlike(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(props.likedBooks){var isSame=props.likedBooks.find(function(book){return book.book_id===props.id;});if(isSame){setLike(true);}else{setLike(false);}}},[props]);console.log(props.likedBooks);return/*#__PURE__*/React.createElement(\"div\",{className:\"searchResult\"},props.volumeInfo.imageLinks?/*#__PURE__*/React.createElement(\"img\",{src:props.volumeInfo.imageLinks.smallThumbnail,alt:\"book cover\"}):null,!isLiked?/*#__PURE__*/React.createElement(BsHeart,{className:\"heartIcon\",onClick:handleLike}):/*#__PURE__*/React.createElement(BsHeartFill,{className:\"heartIcon\",onClick:handleUnlike}),/*#__PURE__*/React.createElement(\"h3\",null,props.volumeInfo.title),/*#__PURE__*/React.createElement(\"div\",{className:\"authors\"},authors?authors.map(function(author,index){// console.log(author)\nreturn/*#__PURE__*/React.createElement(\"h4\",{key:author+index},\" By: \",author);}):null),/*#__PURE__*/React.createElement(\"p\",null,shortenedDesc,\" \",/*#__PURE__*/React.createElement(Link,{to:'/bookdetail/'+props.id},\"...Read More\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,props.volumeInfo.publisher),/*#__PURE__*/React.createElement(\"p\",null,publishedYear)));// }\n};export default isAuthorized(SearchResult);","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/components/SearchResult.js"],"names":["React","useState","useEffect","BsHeart","BsHeartFill","axios","Link","isAuthorized","SearchResult","props","isLiked","setLike","console","log","authors","publishedYear","shortenedDesc","shortenDesc","text","max","length","slice","split","join","volumeInfo","hasOwnProperty","publishedDate","description","map","author","handleLike","toString","post","bookID","id","title","img","imageLinks","thumbnail","response","data","error","handleUnlike","likedBookID","likedBooks","isSame","find","book","book_id","smallThumbnail","index","publisher"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport  '../css/searchResults.css'\r\nimport { BsHeart, BsHeartFill} from \"react-icons/bs\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport isAuthorized from \"../auth/isAuthorized\";\r\n\r\nconst SearchResult = (props) => {\r\n//    const [ searchResults, setSearchResults] = useState(props)\r\n   const [ isLiked, setLike ] = useState(false)\r\n\r\nconsole.log(props)\r\nlet authors = null;\r\nlet publishedYear;\r\nlet shortenedDesc;\r\n\r\nconst shortenDesc = (text,max) => {\r\n    return text && text.length > max ? text.slice(0,max).split(' ').slice(0, -1).join(' ') : text\r\n}\r\n\r\nif(props.volumeInfo.hasOwnProperty('publishedYear')){\r\n    publishedYear = props.volumeInfo.publishedDate.slice(0,4)\r\n}\r\nif(props.volumeInfo.hasOwnProperty('description')){\r\n    shortenedDesc = shortenDesc(props.volumeInfo.description, 150)\r\n}\r\nif(props.volumeInfo.hasOwnProperty('authors')){\r\n    authors = props.volumeInfo.authors.map(author => {\r\n            return author\r\n        })\r\n    }\r\n   \r\n    const handleLike = async () => {\r\n        if(props.isAuthorized){\r\n       if(!props.volumeInfo.hasOwnProperty('authors')){\r\n           authors = null;\r\n       }else{\r\n           authors = authors.toString()\r\n       }\r\n        console.log(authors)\r\n        try{\r\n            const response = await axios.post('https://read-it-react.herokuapp.com/addBookToLibrary', {\r\n                bookID: props.id, \r\n                title: props.volumeInfo.title,\r\n                author: authors,\r\n                img: props.volumeInfo.imageLinks.thumbnail\r\n            })\r\n            console.log(response.data)\r\n            // props.notification(response.data.response)\r\n            setLike(true)\r\n        }catch(err){\r\n            if(err){\r\n                // props.error(err.response.data.error)\r\n                console.log(err.response.data.error)\r\n             }\r\n        }     \r\n        }else{\r\n        props.error('Please login to add a book to your library')\r\n        }    \r\n    }\r\n\r\n    const handleUnlike = async () => {\r\n        console.log('remove from library')\r\n        // if(props.isAuthorized){\r\n        try{\r\n            const response = await axios.post('https://read-it-react.herokuapp.com/removeBookFromLibrary', {likedBookID: props.id})\r\n            console.log(response.data)\r\n           setLike(false)\r\n        }catch(err){\r\n            if(err){\r\n                // props.error(err.response.data.error)\r\n            }\r\n        }    \r\n    // }  \r\n    }\r\n\r\n    useEffect(() => {\r\n        if(props.likedBooks){\r\n            const isSame = props.likedBooks.find(book => book.book_id === props.id)\r\n            if(isSame){\r\n                setLike(true)              \r\n            }else{\r\n                setLike(false)\r\n             }\r\n            }\r\n\r\n    }, [props])\r\n    \r\n    console.log(props.likedBooks)\r\n\r\n    return(\r\n        <div className=\"searchResult\" >\r\n           \r\n            {props.volumeInfo.imageLinks? <img src={props.volumeInfo.imageLinks.smallThumbnail} alt=\"book cover\" /> : null}\r\n            {!isLiked ?\r\n            <BsHeart className=\"heartIcon\" onClick={handleLike}/>\r\n            : <BsHeartFill className=\"heartIcon\" onClick={handleUnlike} /> }\r\n            <h3>{props.volumeInfo.title}</h3>\r\n            <div className=\"authors\">\r\n            {authors? authors.map((author, index) => {\r\n                // console.log(author)\r\n                return <h4 key={author+index}> By: {author}</h4>\r\n            }) : null }\r\n            </div>\r\n            <p>{shortenedDesc} <Link to={'/bookdetail/'+ props.id}>...Read More</Link></p>\r\n            <div>\r\n        \t<p>{props.volumeInfo.publisher}</p>\r\n        \t<p>{publishedYear}</p>\r\n            </div>\r\n            \r\n        </div>\r\n    )\r\n// }\r\n\r\n       \r\n        \r\n    \r\n}\r\nexport default isAuthorized(SearchResult)"]},"metadata":{},"sourceType":"module"}