{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import isAuthorized from\"../auth/isAuthorized\";import{Link,useParams}from\"react-router-dom\";import'../css/reviewBook.css';import axios from'axios';import{makeStyles}from'@material-ui/styles';import{Button,FormControl,Input,InputLabel,TextField}from'@material-ui/core';var useStyles=makeStyles(function(theme){return{submit:{marginTop:theme.spacing*3,justifySelf:'center',color:'white',maxHeight:'40px'}};});var ReviewBook=function ReviewBook(props){var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),book=_useState2[0],setBook=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),reviewText=_useState4[0],setReviewText=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),reviewTitle=_useState6[0],setReviewTitle=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),reviewRating=_useState8[0],setReviewRating=_useState8[1];var _useParams=useParams(),id=_useParams.id;// console.log(id)\nuseEffect(function(){var isFetching=true;var fetchBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios(\"https://www.googleapis.com/books/v1/volumes/\".concat(id),{withCredentials:false});case 2:response=_context.sent;console.log(response.data);if(isFetching){setBook(response.data);}case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchBook(){return _ref.apply(this,arguments);};}();fetchBook();return function(){return isFetching=false;};},[id]);var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();console.log('submit review');_context2.prev=2;_context2.next=5;return axios.post('https://read-it-react.herokuapp.com/addReview',{reviewText:reviewText,reviewRating:reviewRating,bookID:id,reviewTitle:reviewTitle,bookTitle:book.volumeInfo.title,img:book.volumeInfo.imageLinks.smallThumbnail});case 5:props.onNotification('Review successfully posted');props.history.push('/read_it/reviews');_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](2);if(_context2.t0){props.onError(_context2.t0.response.data.error);}case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[2,9]]);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();if(!id){return props.history.push('/read_it/profile');}if(!props.isAuthorized){return/*#__PURE__*/React.createElement(\"div\",{className:\"notAuthorized\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Please login to review this book\"),/*#__PURE__*/React.createElement(Link,{to:\"login\"},\"Login\"));}if(book){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Link,{to:\"/read_it/profile\"},\"Back to Profile\"),/*#__PURE__*/React.createElement(\"div\",{className:\"reviewForm\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Create Review of \",book.volumeInfo.title),/*#__PURE__*/React.createElement(\"img\",{src:book.volumeInfo.imageLinks.smallThumbnail,alt:book.volumeInfo.title+'cover image'}),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"title\"},\"Title of Review\"),/*#__PURE__*/React.createElement(Input,{name:\"title\",type:\"text\",id:\"title\",onChange:function onChange(e){return setReviewTitle(e.target.value);}})),/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"rating\"},\"Rating\"),/*#__PURE__*/React.createElement(Input,{name:\"rating\",type:\"number\",id:\"rating\",onChange:function onChange(e){return setReviewRating(e.target.value);}})),/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",required:true,fullWidth:true},/*#__PURE__*/React.createElement(TextField,{required:true,id:\"standard-textarea\",label:\"Review\",multiline:true,onChange:function onChange(e){return setReviewText(e.target.value);}})),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"secondary\",className:classes.submit,onClick:function onClick(e){return handleClick(e);}},\"Submit Review\"))));}else{return/*#__PURE__*/React.createElement(\"h1\",null,\"Review\");}};export default isAuthorized(ReviewBook);","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/pages/ReviewBook.js"],"names":["React","useState","useEffect","isAuthorized","Link","useParams","axios","makeStyles","Button","FormControl","Input","InputLabel","TextField","useStyles","theme","submit","marginTop","spacing","justifySelf","color","maxHeight","ReviewBook","props","classes","book","setBook","reviewText","setReviewText","reviewTitle","setReviewTitle","reviewRating","setReviewRating","id","isFetching","fetchBook","withCredentials","response","console","log","data","handleClick","e","preventDefault","post","bookID","bookTitle","volumeInfo","title","img","imageLinks","smallThumbnail","onNotification","history","push","onError","error","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport isAuthorized from \"../auth/isAuthorized\";\r\nimport { Link, useParams  } from \"react-router-dom\";\r\nimport  '../css/reviewBook.css'\r\n\r\nimport axios from 'axios'\r\n\r\nimport { makeStyles } from '@material-ui/styles'\r\nimport {\r\n    Button,\r\n    FormControl,\r\n    Input,\r\n    InputLabel,\r\n    TextField\r\n  } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n     submit: {\r\n      marginTop: theme.spacing * 3,\r\n      justifySelf: 'center',\r\n      color:'white',\r\n      maxHeight: '40px'\r\n    },\r\n  }));\r\n\r\n\r\nconst ReviewBook = (props) => {\r\n\r\n    const classes = useStyles()\r\n\r\n    const [ book, setBook ] = useState()\r\n    const [ reviewText, setReviewText ] = useState()\r\n    const [ reviewTitle, setReviewTitle ] = useState()\r\n    const [ reviewRating, setReviewRating ] = useState()\r\n\r\n   let { id }= useParams()\r\n    // console.log(id)\r\n\r\n\r\n    useEffect(() => {\r\n        let isFetching = true\r\n        const fetchBook = async () => {\r\n          \r\n            const response = await axios(`https://www.googleapis.com/books/v1/volumes/${id}`, {withCredentials:false})\r\n            console.log(response.data)\r\n            if(isFetching){\r\n                setBook(response.data)\r\n            }\r\n        }\r\n\r\n        fetchBook()\r\n        return () => isFetching = false\r\n    },[id])\r\n\r\n    const handleClick = async (e) => {\r\n        e.preventDefault()\r\n        console.log('submit review')\r\n        try{\r\n            await axios.post('https://read-it-react.herokuapp.com/addReview', {\r\n            reviewText, \r\n            reviewRating,\r\n            bookID:id,\r\n            reviewTitle,\r\n            bookTitle: book.volumeInfo.title,\r\n            img: book.volumeInfo.imageLinks.smallThumbnail\r\n        })\r\n        props.onNotification('Review successfully posted')\r\n                props.history.push('/read_it/reviews')\r\n        }catch(err){\r\n            if(err){\r\n                props.onError(err.response.data.error)\r\n             }\r\n        }\r\n        \r\n    }\r\n\r\n    if(!id){\r\n        return (\r\n            props.history.push('/read_it/profile')\r\n        )\r\n    }\r\n\r\n    if(!props.isAuthorized){\r\n        return(\r\n            <div className=\"notAuthorized\">\r\n                <h1>Please login to review this book</h1>\r\n                <Link to=\"login\">Login</Link>\r\n            </div>\r\n            )\r\n    }\r\n    if(book){\r\n        \r\n    return (\r\n        <>\r\n        <Link to=\"/read_it/profile\">Back to Profile</Link>\r\n        \r\n        <div className=\"reviewForm\">\r\n      \r\n            <h1>Create Review of {book.volumeInfo.title}</h1>\r\n        \r\n            <img src={book.volumeInfo.imageLinks.smallThumbnail} alt={book.volumeInfo.title + 'cover image'}/>\r\n        \r\n            <form>\r\n            <FormControl margin=\"normal\" required fullWidth>\r\n                <InputLabel htmlFor=\"title\">Title of Review</InputLabel>\r\n                <Input name=\"title\" type=\"text\" id=\"title\" onChange={(e) => setReviewTitle(e.target.value)}/>\r\n          </FormControl>\r\n            <FormControl margin=\"normal\" required fullWidth>\r\n                <InputLabel htmlFor=\"rating\">Rating</InputLabel>\r\n                <Input name=\"rating\" type=\"number\" id=\"rating\" onChange={(e) => setReviewRating(e.target.value)}/>\r\n          </FormControl>\r\n            <FormControl margin=\"normal\" required fullWidth>\r\n                {/* <InputLabel htmlFor=\"review\">Review</InputLabel> */}\r\n                <TextField required\r\n          id=\"standard-textarea\"\r\n          label=\"Review\"\r\n          multiline\r\n  onChange={(e) => setReviewText(e.target.value)}/>\r\n          </FormControl>\r\n          \r\n            <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            className={classes.submit}\r\n             onClick={(e) => handleClick(e)}>Submit Review</Button>\r\n        </form>\r\n      \r\n        </div>\r\n        </>\r\n    )\r\n    }else{\r\n        return <h1>Review</h1>\r\n    }\r\n}\r\n\r\nexport default isAuthorized(ReviewBook)"]},"metadata":{},"sourceType":"module"}