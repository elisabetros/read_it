{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from'axios';import isAuthorized from'../auth/isAuthorized';import Review from'../components/Review';import{Link,useHistory}from\"react-router-dom\";import{BsHeartFill,BsFillTrashFill,BsFillStarFill}from\"react-icons/bs\";import'../css/profile.css';import{makeStyles}from'@material-ui/styles';import{Button,FormControl,Input,InputLabel}from'@material-ui/core';var useStyles=makeStyles(function(theme){return{submit:{marginTop:theme.spacing*3,justifySelf:'center',color:'white'},delete:{backgroundColor:'rgb(61, 60, 60)',color:'white'}};});var Profile=function Profile(props){var classes=useStyles();var _useState=useState(),_useState2=_slicedToArray(_useState,2),booksInLibrary=_useState2[0],setBooks=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),reviewedBooks=_useState4[0],setReviewedBooks=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),edit=_useState6[0],setEdit=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),newFirstname=_useState8[0],setNewFirstname=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),newLastname=_useState10[0],setNewLastname=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),newEmail=_useState12[0],setNewEmail=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),deleteModel=_useState14[0],setDeleteModel=_useState14[1];var history=useHistory();useEffect(function(){var isFetching=true;var fetchBooksInLibrary=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios('https://read-it-react.herokuapp.com/getBooksInLibrary');case 3:response=_context.sent;console.log(response.data);if(isFetching){setBooks(response.data);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(_context.t0){props.onError(_context.t0.response.data.error);}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchBooksInLibrary(){return _ref.apply(this,arguments);};}();var fetchReviewedBooks=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios('https://read-it-react.herokuapp.com/getUserReviewedBooks');case 3:response=_context2.sent;console.log(response.data);if(isFetching){setReviewedBooks(response.data);}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);if(_context2.t0){props.onError(_context2.t0.response.data.error);}case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function fetchReviewedBooks(){return _ref2.apply(this,arguments);};}();if(props.isAuthorized){fetchBooksInLibrary();fetchReviewedBooks();}return function(){return isFetching=false;};},[props.isAuthorized]);var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();console.log('submit profile changes');// if(!newEmail || !newFirstname || !newLastname){\n//                \n// }\nif(!(newEmail||newFirstname||newLastname)){_context3.next=17;break;}_context3.prev=3;_context3.next=6;return axios.post('https://read-it-react.herokuapp.com/user/update',{newFirstname:newFirstname,newLastname:newLastname,newEmail:newEmail});case 6:response=_context3.sent;console.log(response.data);props.onNotification(response.data.response);setEdit(false);_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](3);if(_context3.t0){props.onError(_context3.t0.response.data.error);}case 15:_context3.next=18;break;case 17:props.onError('Please fill out information you would like changed');case 18:case\"end\":return _context3.stop();}}},_callee3,null,[[3,12]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();var showDeleteModel=function showDeleteModel(){console.log('delete');return/*#__PURE__*/React.createElement(\"div\",{className:\"model\"},/*#__PURE__*/React.createElement(\"div\",{className:\"model-content\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Are you sure you want to delete your account?\"),/*#__PURE__*/React.createElement(\"p\",null,\"This action cannot be reversed\"),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",className:classes.delete,onClick:deleteAccount},\"Delete\"),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,color:\"secondary\",variant:\"contained\",className:classes.submit,onClick:function onClick(){return setDeleteModel(false);}},\"Cancel\")));};var deleteAccount=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.delete('https://read-it-react.herokuapp.com/user/deleteAccount');case 3:response=_context4.sent;console.log(response.data);props.onNotification(response.data.response);history.push('/read_it/');_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);if(_context4.t0){props.onError(_context4.t0.response.data.error);}case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return function deleteAccount(){return _ref4.apply(this,arguments);};}();var handleClick=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){var response,newBooksInLibrary;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log('remove from library',id);_context5.prev=1;_context5.next=4;return axios.post('https://read-it-react.herokuapp.com/removeBookFromLibrary',{likedBookID:id});case 4:response=_context5.sent;console.log(response.data);console.log(booksInLibrary);newBooksInLibrary=booksInLibrary.filter(function(book){return book.book_id!==id;});setBooks(newBooksInLibrary);_context5.next=14;break;case 11:_context5.prev=11;_context5.t0=_context5[\"catch\"](1);if(_context5.t0){props.onError(_context5.t0.response.data.error);}case 14:case\"end\":return _context5.stop();}}},_callee5,null,[[1,11]]);}));return function handleClick(_x2){return _ref5.apply(this,arguments);};}();var handleDeleteReview=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(id){var response,newReviewedBooks;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return axios.post('https://read-it-react.herokuapp.com/deleteReview',{id:id});case 3:response=_context6.sent;console.log(response.data);props.onNotification(response.data.response);newReviewedBooks=reviewedBooks.filter(function(review){return review.id!==id;});setReviewedBooks(newReviewedBooks);_context6.next=13;break;case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);if(_context6.t0){props.onError(_context6.t0.response.data.error);}case 13:case\"end\":return _context6.stop();}}},_callee6,null,[[0,10]]);}));return function handleDeleteReview(_x3){return _ref6.apply(this,arguments);};}();if(!props.isAuthorized){return/*#__PURE__*/React.createElement(\"div\",{className:\"notAuthorized\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Log in to view your profile\"),/*#__PURE__*/React.createElement(Link,{to:\"/read_it/login\"},\" Login\"));}return/*#__PURE__*/React.createElement(\"div\",{className:\"profile\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Your Library\"),/*#__PURE__*/React.createElement(\"div\",{className:\"library\"},booksInLibrary?booksInLibrary.map(function(book){return/*#__PURE__*/React.createElement(\"div\",{className:\"book\",key:book.id},/*#__PURE__*/React.createElement(BsHeartFill,{className:\"heartIcon\",onClick:function onClick(){return handleClick(book.book_id);}}),/*#__PURE__*/React.createElement(\"img\",{src:book.img,alt:\"Book cover\"}),/*#__PURE__*/React.createElement(\"h3\",null,book.title),/*#__PURE__*/React.createElement(\"h4\",null,book.author),/*#__PURE__*/React.createElement(Link,{to:\"/read_it/reviewbook/\"+book.book_id},\"Review Book\"));}):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"There appears to be nothing in your library\"),/*#__PURE__*/React.createElement(Link,{to:\"/\"},\"Browse Books\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"userReviews\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Your Reviews\"),reviewedBooks?reviewedBooks.map(function(review){return/*#__PURE__*/React.createElement(Review,Object.assign({},review,{onDelete:handleDeleteReview}));}):null),/*#__PURE__*/React.createElement(\"button\",{className:edit?'shown editBtn':'editBtn',onClick:function onClick(){return edit?setEdit(false):setEdit(true);}},\"Edit your information\"),/*#__PURE__*/React.createElement(\"form\",{className:edit?'showForm editForm':'editForm'},/*#__PURE__*/React.createElement(\"h3\",null,\"Update your information\"),/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"newFirstname\"},\"Firstname\"),/*#__PURE__*/React.createElement(Input,{name:\"newFirstname\",type:\"text\",id:\"newFirstname\",onChange:function onChange(e){return setNewFirstname(e.target.value);}})),/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"newLastname\"},\"Lastname\"),/*#__PURE__*/React.createElement(Input,{name:\"newLastname\",type:\"text\",id:\"newLastname\",onChange:function onChange(e){return setNewLastname(e.target.value);}})),/*#__PURE__*/React.createElement(FormControl,{margin:\"normal\",fullWidth:true},/*#__PURE__*/React.createElement(InputLabel,{htmlFor:\"newEmail\"},\"Email\"),/*#__PURE__*/React.createElement(Input,{name:\"newEmail\",type:\"text\",id:\"newEmail\",onChange:function onChange(e){return setNewEmail(e.target.value);}})),/*#__PURE__*/React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"secondary\",className:classes.submit,onClick:function onClick(e){return handleSubmit(e);}},\"Submit Changes\")),/*#__PURE__*/React.createElement(\"div\",{className:\"dltBtn btn\",onClick:function onClick(){return setDeleteModel(true);}},/*#__PURE__*/React.createElement(BsFillTrashFill,null),\"Delete Account\"),deleteModel?showDeleteModel():null);};export default isAuthorized(Profile);","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/pages/Profile.js"],"names":["React","useState","useEffect","axios","isAuthorized","Review","Link","useHistory","BsHeartFill","BsFillTrashFill","BsFillStarFill","makeStyles","Button","FormControl","Input","InputLabel","useStyles","theme","submit","marginTop","spacing","justifySelf","color","delete","backgroundColor","Profile","props","classes","booksInLibrary","setBooks","reviewedBooks","setReviewedBooks","edit","setEdit","newFirstname","setNewFirstname","newLastname","setNewLastname","newEmail","setNewEmail","deleteModel","setDeleteModel","history","isFetching","fetchBooksInLibrary","response","console","log","data","onError","error","fetchReviewedBooks","handleSubmit","e","preventDefault","post","onNotification","showDeleteModel","deleteAccount","push","handleClick","id","likedBookID","newBooksInLibrary","filter","book","book_id","handleDeleteReview","newReviewedBooks","review","map","img","title","author","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport axios from 'axios'\r\n\r\nimport isAuthorized from '../auth/isAuthorized'\r\nimport Review from '../components/Review'\r\n\r\nimport { Link, useHistory } from \"react-router-dom\"\r\nimport { BsHeartFill, BsFillTrashFill, BsFillStarFill } from \"react-icons/bs\";\r\nimport '../css/profile.css'\r\n\r\nimport { makeStyles } from '@material-ui/styles'\r\nimport {\r\n    Button,\r\n    FormControl,\r\n    Input,\r\n    InputLabel\r\n  } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    submit: {\r\n     marginTop: theme.spacing * 3,\r\n     justifySelf: 'center',\r\n     color:'white'\r\n   },\r\n   delete: {\r\n       backgroundColor: 'rgb(61, 60, 60)',\r\n       color:'white'\r\n   }\r\n }));\r\n\r\nconst Profile = (props) => {\r\n    const classes = useStyles()\r\n\r\n    const [ booksInLibrary, setBooks ] = useState()\r\n    const [ reviewedBooks, setReviewedBooks ] = useState()\r\n    const [ edit, setEdit ] = useState(false)\r\n    const [ newFirstname, setNewFirstname ] = useState()\r\n    const [ newLastname, setNewLastname ] = useState()\r\n    const [ newEmail, setNewEmail ] = useState()\r\n\r\n    const [ deleteModel, setDeleteModel ] = useState(false)\r\n\r\n\r\n    let history = useHistory()\r\n    \r\n    \r\n   \r\n   \r\n    useEffect(() => {\r\n        let isFetching = true\r\n      \r\n        const fetchBooksInLibrary = async () => {\r\n            try{\r\n                const response = await axios('https://read-it-react.herokuapp.com/getBooksInLibrary')\r\n                console.log(response.data)\r\n                if(isFetching){\r\n                    setBooks(response.data)\r\n                }\r\n            }catch(err){\r\n                if(err){\r\n                    props.onError(err.response.data.error)\r\n                 }\r\n            }\r\n           \r\n        }\r\n        const fetchReviewedBooks = async () => {\r\n            try{\r\n                const response = await axios('https://read-it-react.herokuapp.com/getUserReviewedBooks')\r\n                console.log(response.data)\r\n                if(isFetching){\r\n                    setReviewedBooks(response.data)\r\n                }\r\n            }catch(err){\r\n                if(err){\r\n                    props.onError(err.response.data.error)\r\n                 }\r\n            }\r\n           \r\n        }\r\n        if(props.isAuthorized){\r\n\r\n            fetchBooksInLibrary()\r\n            fetchReviewedBooks()\r\n        }\r\n        return () => isFetching = false\r\n    },[props.isAuthorized])\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault()\r\n        console.log('submit profile changes')\r\n        // if(!newEmail || !newFirstname || !newLastname){\r\n        //                \r\n        // }\r\n        if(newEmail || newFirstname || newLastname){\r\n            try{\r\n                const response = await axios.post('https://read-it-react.herokuapp.com/user/update', {\r\n                    newFirstname,\r\n                    newLastname,\r\n                    newEmail\r\n                })\r\n            console.log(response.data)\r\n            props.onNotification(response.data.response)\r\n            setEdit(false)\r\n            }catch(err){\r\n                if(err){\r\n                    props.onError(err.response.data.error)                    \r\n                 }\r\n            }\r\n           \r\n       \r\n\r\n        }else{\r\n            props.onError('Please fill out information you would like changed') \r\n        }\r\n    }\r\n    const showDeleteModel = () => {\r\n        console.log('delete')\r\n        return(\r\n            <div className=\"model\">\r\n                <div className=\"model-content\">\r\n                <h2>Are you sure you want to delete your account?</h2>\r\n                <p>This action cannot be reversed</p>\r\n                 <Button type=\"submit\"\r\n                    fullWidth\r\n                    variant=\"contained\"\r\n                    className={classes.delete}  \r\n                    onClick={deleteAccount}>Delete</Button> \r\n                <Button type=\"submit\"\r\n                    fullWidth\r\n                    color=\"secondary\"\r\n                    variant=\"contained\"\r\n                    className={classes.submit}  \r\n                    onClick={()=>setDeleteModel(false)}>Cancel</Button>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    \r\n    const deleteAccount = async () => {\r\n        try{\r\n            const response =  await axios.delete('https://read-it-react.herokuapp.com/user/deleteAccount')\r\n        console.log(response.data)\r\n        props.onNotification(response.data.response)\r\n            history.push('/read_it/')\r\n        }catch(err){\r\n            if(err){\r\n                props.onError(err.response.data.error)\r\n                \r\n             }\r\n        }\r\n       \r\n    }\r\n\r\n\r\n    const handleClick = async (id) => {\r\n        console.log('remove from library', id)\r\n        try{\r\n            const response = await axios.post('https://read-it-react.herokuapp.com/removeBookFromLibrary', {likedBookID: id})\r\n            console.log(response.data)\r\n            console.log(booksInLibrary)\r\n            const newBooksInLibrary = booksInLibrary.filter(book=> book.book_id !== id)\r\n            setBooks(newBooksInLibrary)\r\n        }catch(err){\r\n            if(err){\r\n                props.onError(err.response.data.error)\r\n            }\r\n        }       \r\n    }\r\n\r\n    const handleDeleteReview = async (id) => {\r\n        try{\r\n            const response =  await axios.post('https://read-it-react.herokuapp.com/deleteReview', {id})\r\n        console.log(response.data)\r\n        props.onNotification(response.data.response)\r\n        const newReviewedBooks = reviewedBooks.filter(review => review.id !== id)\r\n        setReviewedBooks(newReviewedBooks)\r\n            \r\n        }catch(err){\r\n            if(err){\r\n                props.onError(err.response.data.error)                \r\n             }\r\n        }\r\n    }\r\n\r\n    if(!props.isAuthorized){\r\n         return (<div className=\"notAuthorized\">\r\n            <h1>Log in to view your profile</h1>\r\n            <Link to=\"/read_it/login\"> Login</Link></div>)\r\n    }\r\n\r\n    return(\r\n        <div className=\"profile\">\r\n       \r\n        <div>            \r\n            <h2>Your Library</h2>\r\n            <div className=\"library\">\r\n            {booksInLibrary?\r\n                booksInLibrary.map(book => {\r\n                    return (<div className='book' key={book.id} >\r\n                            <BsHeartFill className=\"heartIcon\" onClick={()=>handleClick(book.book_id)}/>\r\n                            <img src={book.img} alt=\"Book cover\"/>\r\n                            <h3>{book.title}</h3>\r\n                            <h4>{book.author}</h4>\r\n                            <Link to={\"/read_it/reviewbook/\"+book.book_id}>Review Book</Link>\r\n                        </div>)\r\n                })\r\n                :<div>\r\n                    <h2>There appears to be nothing in your library</h2>\r\n                    <Link to=\"/\">Browse Books</Link>\r\n                </div>}\r\n            </div>\r\n        </div>\r\n        <div className=\"userReviews\">\r\n                <h2>Your Reviews</h2>\r\n                {reviewedBooks?\r\n                reviewedBooks.map(review => {\r\n                    return <Review {...review} onDelete={handleDeleteReview}/>\r\n                })\r\n                :null}\r\n                \r\n        </div>\r\n        \r\n        <button className={edit? 'shown editBtn': 'editBtn'} onClick={() => edit? setEdit(false): setEdit(true)}>Edit your information</button>\r\n        <form className={edit? 'showForm editForm' :'editForm'}>\r\n            <h3>Update your information</h3>\r\n             <FormControl margin=\"normal\"  fullWidth>\r\n                <InputLabel htmlFor=\"newFirstname\">Firstname</InputLabel>\r\n                <Input name=\"newFirstname\" type=\"text\" id=\"newFirstname\"  onChange={(e) => setNewFirstname(e.target.value)}/>\r\n          </FormControl> \r\n           <FormControl margin=\"normal\"  fullWidth>\r\n                <InputLabel htmlFor=\"newLastname\">Lastname</InputLabel>\r\n                <Input name=\"newLastname\" type=\"text\" id=\"newLastname\"  onChange={(e) => setNewLastname(e.target.value)}/>\r\n          </FormControl> \r\n            <FormControl margin=\"normal\"  fullWidth>\r\n               <InputLabel htmlFor=\"newEmail\">Email</InputLabel>\r\n                <Input name=\"newEmail\" type=\"text\" id=\"newEmail\"  onChange={(e) => setNewEmail(e.target.value)}/>\r\n          </FormControl>\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            color=\"secondary\"\r\n            className={classes.submit}\r\n            onClick={(e) => handleSubmit(e)}>Submit Changes</Button> \r\n         </form>\r\n         <div className=\"dltBtn btn\" onClick={() => setDeleteModel(true)}><BsFillTrashFill />Delete Account</div>\r\n         {deleteModel? showDeleteModel(): null}\r\n        </div>\r\n    )\r\n\r\n}\r\nexport default isAuthorized(Profile)"]},"metadata":{},"sourceType":"module"}