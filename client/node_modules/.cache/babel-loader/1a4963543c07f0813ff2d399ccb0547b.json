{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\el\\xEDsabet\\\\Documents\\\\web-dev\\\\react\\\\react_final_exam\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useParams,useHistory}from'react-router-dom';import axios from'axios';import'../css/bookDetail.css';import parse from'html-react-parser';import Review from\"../components/Review\";var BookDetail=function BookDetail(props){var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _useState=useState(),_useState2=_slicedToArray(_useState,2),book=_useState2[0],setBook=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),reviews=_useState4[0],setReviews=_useState4[1];useEffect(function(){var isFetching=true;var fetchBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios(\"https://www.googleapis.com/books/v1/volumes/\".concat(id),{withCredentials:false});case 3:response=_context.sent;if(isFetching){setBook(response.data);}_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);props.onError(_context.t0.response.data.error);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return function fetchBook(){return _ref.apply(this,arguments);};}();var fetchReviews=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios(\"https://read-it-react.herokuapp.com/getSingleBookReviews/\".concat(id));case 3:response=_context2.sent;console.log(response.data);if(isFetching){setReviews(response.data);}// && response.data.length\n_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);props.onError(_context2.t0.response.data.error);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function fetchReviews(){return _ref2.apply(this,arguments);};}();fetchBook();fetchReviews();return function(){return isFetching=false;};},[props,id]);if(!book){return/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"},\"Loading...\");}console.log(history);console.log(book);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"button\",{className:\"link\",onClick:function onClick(){return history.goBack();}},\"Back\"),/*#__PURE__*/React.createElement(\"div\",{className:\"bookDetail\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,book.volumeInfo.title),/*#__PURE__*/React.createElement(\"h2\",null,book.volumeInfo.subtitle)),/*#__PURE__*/React.createElement(\"img\",{src:book.volumeInfo.imageLinks.smallThumbnail,alt:\"book cover\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"pub-authors\"},/*#__PURE__*/React.createElement(\"div\",null,book.volumeInfo.authors?book.volumeInfo.authors.map(function(author,index){// console.log(author)\nreturn/*#__PURE__*/React.createElement(\"h4\",{key:author+index},\" By: \",author);}):null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,\"Published: \",new Date(book.volumeInfo.publishedDate).toDateString().slice(4,15)),/*#__PURE__*/React.createElement(\"p\",null,\"Published by: \",/*#__PURE__*/React.createElement(\"strong\",null,book.volumeInfo.publisher)))),book.volumeInfo.description?/*#__PURE__*/React.createElement(\"div\",null,parse(book.volumeInfo.description)):null,/*#__PURE__*/React.createElement(\"a\",{href:book.volumeInfo.infoLink},\"More Information\")),/*#__PURE__*/React.createElement(\"div\",{className:\"reviews\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Reviews\"),reviews?reviews.map(function(review){return/*#__PURE__*/React.createElement(Review,Object.assign({},review,{key:review.id}));}):null));};export default BookDetail;","map":{"version":3,"sources":["C:/Users/elÃ­sabet/Documents/web-dev/react/react_final_exam/client/src/pages/BookDetail.js"],"names":["React","useEffect","useState","useParams","useHistory","axios","parse","Review","BookDetail","props","id","history","book","setBook","reviews","setReviews","isFetching","fetchBook","withCredentials","response","data","onError","error","fetchReviews","console","log","goBack","volumeInfo","title","subtitle","imageLinks","smallThumbnail","authors","map","author","index","Date","publishedDate","toDateString","slice","publisher","description","infoLink","review"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useParams, useHistory} from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport '../css/bookDetail.css'\r\nimport parse from 'html-react-parser';\r\nimport Review from \"../components/Review\";\r\n\r\nconst BookDetail = (props) => {\r\n\r\n    let { id }= useParams()\r\n    \r\n    let history = useHistory()\r\n\r\n   \r\n    const [ book, setBook ] = useState()\r\n    const [ reviews, setReviews ] = useState()\r\n\r\n    \r\n\r\n    useEffect(() => {\r\n        let isFetching = true\r\n        const fetchBook= async () => {\r\n            try{\r\n               const response =  await axios(`https://www.googleapis.com/books/v1/volumes/${id}`, { withCredentials: false })\r\n                if(isFetching){\r\n                    setBook(response.data)\r\n                }\r\n            }catch(err){\r\n                props.onError(err.response.data.error)\r\n            }\r\n        }\r\n        const fetchReviews = async () => {\r\n            try{\r\n                const response = await axios (`https://read-it-react.herokuapp.com/getSingleBookReviews/${id}`)\r\n                console.log(response.data)\r\n                if(isFetching){\r\n                    setReviews(response.data)\r\n                } // && response.data.length\r\n            }catch(err){\r\n                props.onError(err.response.data.error)\r\n            }\r\n        }\r\n        fetchBook()\r\n        fetchReviews()\r\n        return () => isFetching = false\r\n    }, [props, id])\r\n\r\n\r\n\r\nif(!book){\r\n    return <div className=\"loader\">Loading...</div>\r\n}\r\n\r\nconsole.log(history)\r\nconsole.log(book)\r\n    return (\r\n        <>\r\n        <button className=\"link\" onClick={() => history.goBack()}>Back</button>\r\n        <div className=\"bookDetail\">\r\n            <div>\r\n                <h1>{book.volumeInfo.title}</h1>\r\n                <h2>{book.volumeInfo.subtitle}</h2>\r\n            </div>\r\n            <img src={book.volumeInfo.imageLinks.smallThumbnail} alt=\"book cover\"/>\r\n            <div className=\"pub-authors\">\r\n                <div>\r\n                {book.volumeInfo.authors? book.volumeInfo.authors.map((author, index) => {\r\n                        // console.log(author)\r\n                        return <h4 key={author+index}> By: {author}</h4>\r\n                    }) : null }\r\n                </div>\r\n                <div>\r\n                    <p>Published: {new Date(book.volumeInfo.publishedDate).toDateString().slice(4,15)}</p>\r\n                    <p>Published by: <strong>{book.volumeInfo.publisher}</strong></p>\r\n                </div>\r\n            </div>\r\n            {book.volumeInfo.description? <div>{parse(book.volumeInfo.description)}</div>: null}\r\n        \r\n            <a href={book.volumeInfo.infoLink}>More Information</a>\r\n        </div>\r\n        <div className=\"reviews\">\r\n            <h2>Reviews</h2>\r\n            {reviews ? \r\n            reviews.map(review => {\r\n               return <Review {...review} key={review.id}/>\r\n            })\r\n        : null}\r\n        </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default BookDetail"]},"metadata":{},"sourceType":"module"}